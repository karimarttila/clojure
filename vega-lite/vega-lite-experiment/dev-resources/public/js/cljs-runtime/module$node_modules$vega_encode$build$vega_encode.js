shadow$provide.module$node_modules$vega_encode$build$vega_encode=function(global$jscomp$0,require,module,exports$jscomp$0){(function(global,factory){"object"===typeof exports$jscomp$0&&"undefined"!==typeof module?factory(exports$jscomp$0,require("module$node_modules$vega_dataflow$build$vega_dataflow"),require("module$node_modules$vega_scale$build$vega_scale"),require("module$node_modules$vega_util$build$vega_util"),require("module$node_modules$d3_array$dist$d3_array"),require("module$node_modules$d3_interpolate$dist$d3_interpolate")):
"function"===typeof define&&define.amd?define("exports vega-dataflow vega-scale vega-util d3-array d3-interpolate".split(" "),factory):(global="undefined"!==typeof globalThis?globalThis:global||self,factory(global.vega={},global.vega,global.vega,global.vega,global.d3,global.d3))})(this,function(exports,vegaDataflow,vegaScale,vegaUtil,d3Array,d3Interpolate){function AxisTicks(params){vegaDataflow.Transform.call(this,null,params)}function DataJoin(params){vegaDataflow.Transform.call(this,null,params)}
function defaultItemCreate(){return vegaDataflow.ingest({})}function newMap(key){var map=vegaUtil.fastmap().test(function(t){return t.exit});map.lookup=function(t){return map.get(key(t))};return map}function Encode(params){vegaDataflow.Transform.call(this,null,params)}function LegendEntries(params){vegaDataflow.Transform.call(this,[],params)}function LinkPath(params){vegaDataflow.Transform.call(this,{},params)}function Pie(params){vegaDataflow.Transform.call(this,null,params)}function includePad(type){return vegaScale.isContinuous(type)&&
type!==vegaScale.Sequential}function Scale(params){vegaDataflow.Transform.call(this,null,params);this.modified(!0)}function domainCheck(type,domain,df){vegaScale.isLogarithmic(type)&&Math.abs(domain.reduce(function(s,v){return s+(0>v?-1:0<v?1:0)},0))!==domain.length&&df.warn("Log scale domain includes zero: "+vegaUtil.stringValue(domain));return domain}function adjustScheme(scheme,extent,reverse){return vegaUtil.isFunction(scheme)&&(extent||reverse)?vegaScale.interpolateRange(scheme,flip(extent||
[0,1],reverse)):scheme}function flip(array,reverse){return reverse?array.slice().reverse():array}function SortItems(params){vegaDataflow.Transform.call(this,null,params)}function Stack(params){vegaDataflow.Transform.call(this,null,params)}function stackCenter(group,max,field,y0,y1){max=(max-group.sum)/2;for(var m=group.length,j=0,t;j<m;++j)t=group[j],t[y0]=max,t[y1]=max+=Math.abs(field(t))}function stackNormalize(group,max,field,y0,y1){max=1/group.sum;for(var last=0,m=group.length,j=0,v=0,t;j<m;++j)t=
group[j],t[y0]=last,t[y1]=last=max*(v+=Math.abs(field(t)))}function stackZero(group,max,field,y0,y1){for(var lastNeg=max=0,m=group.length,j=0,v,t;j<m;++j)t=group[j],v=+field(t),0>v?(t[y0]=lastNeg,t[y1]=lastNeg+=v):(t[y0]=max,t[y1]=max+=v)}function partition(data,groupby,sort,field){var groups=[],get=function(f){return f(t)},n;if(null==groupby)groups.push(data.slice());else{var map={};var i=0;for(n=data.length;i<n;++i){var t=data[i];var k=groupby.map(get);var g=map[k];g||(map[k]=g=[],groups.push(g));
g.push(t)}}get=k=0;for(data=groups.length;k<data;++k){g=groups[k];groupby=i=0;for(n=g.length;i<n;++i)groupby+=Math.abs(field(g[i]));g.sum=groupby;groupby>get&&(get=groupby);sort&&g.sort(sort)}groups.max=get;return groups}vegaUtil.inherits(AxisTicks,vegaDataflow.Transform,{transform:function(_,pulse){if(this.value&&!_.modified())return pulse.StopPropagation;var locale=pulse.dataflow.locale();pulse=pulse.fork(pulse.NO_SOURCE|pulse.NO_FIELDS);var ticks=this.value,scale=_.scale,count=vegaScale.tickCount(scale,
null==_.count?_.values?_.values.length:10:_.count,_.minstep),format=_.format||vegaScale.tickFormat(locale,scale,count,_.formatSpecifier,_.formatType,!!_.values),values=_.values?vegaScale.validTicks(scale,_.values,count):vegaScale.tickValues(scale,count);ticks&&(pulse.rem=ticks);ticks=values.map(function(value,i){return vegaDataflow.ingest({index:i/(values.length-1||1),value:value,label:format(value)})});_.extra&&ticks.length&&ticks.push(vegaDataflow.ingest({index:-1,extra:{value:ticks[0].value},label:""}));
pulse.source=ticks;this.value=pulse.add=ticks;return pulse}});vegaUtil.inherits(DataJoin,vegaDataflow.Transform,{transform:function(_,pulse){var df=pulse.dataflow,out=pulse.fork(pulse.NO_SOURCE|pulse.NO_FIELDS),item=_.item||defaultItemCreate,key=_.key||vegaDataflow.tupleid,map=this.value;vegaUtil.isArray(out.encode)&&(out.encode=null);map&&(_.modified("key")||pulse.modified(key))&&vegaUtil.error("DataJoin does not support modified key function or fields.");map||(pulse=pulse.addAll(),this.value=map=
newMap(key));pulse.visit(pulse.ADD,function(t){var k=key(t),x=map.get(k);x?x.exit?(map.empty--,out.add.push(x)):out.mod.push(x):(x=item(t),map.set(k,x),out.add.push(x));x.datum=t;x.exit=!1});pulse.visit(pulse.MOD,function(t){var k=key(t);if(k=map.get(k))k.datum=t,out.mod.push(k)});pulse.visit(pulse.REM,function(t){var k=key(t);k=map.get(k);t!==k.datum||k.exit||(out.rem.push(k),k.exit=!0,++map.empty)});pulse.changed(pulse.ADD_MOD)&&out.modifies("datum");(pulse.clean()||_.clean&&map.empty>df.cleanThreshold)&&
df.runAfter(map.clean);return out}});vegaUtil.inherits(Encode,vegaDataflow.Transform,{transform:function(_,pulse){var out=pulse.fork(pulse.ADD_REM),fmod=_.mod||!1,encoders=_.encoders,encode=pulse.encode;if(vegaUtil.isArray(encode))if(out.changed()||encode.every(function(e){return encoders[e]}))encode=encode[0],out.encode=null;else return pulse.StopPropagation;var reenter="enter"===encode,update=encoders.update||vegaUtil.falsy,enter=encoders.enter||vegaUtil.falsy,exit=encoders.exit||vegaUtil.falsy,
set=(encode&&!reenter?encoders[encode]:update)||vegaUtil.falsy;pulse.changed(pulse.ADD)&&(pulse.visit(pulse.ADD,function(t){enter(t,_);update(t,_)}),out.modifies(enter.output),out.modifies(update.output),set!==vegaUtil.falsy&&set!==update&&(pulse.visit(pulse.ADD,function(t){set(t,_)}),out.modifies(set.output)));pulse.changed(pulse.REM)&&exit!==vegaUtil.falsy&&(pulse.visit(pulse.REM,function(t){exit(t,_)}),out.modifies(exit.output));if(reenter||set!==vegaUtil.falsy)encode=pulse.MOD|(_.modified()?pulse.REFLOW:
0),reenter?(pulse.visit(encode,function(t){var mod=enter(t,_)||fmod;(set(t,_)||mod)&&out.mod.push(t)}),out.mod.length&&out.modifies(enter.output)):pulse.visit(encode,function(t){(set(t,_)||fmod)&&out.mod.push(t)}),out.mod.length&&out.modifies(set.output);return out.changed()?out:pulse.StopPropagation}});vegaUtil.inherits(LegendEntries,vegaDataflow.Transform,{transform:function(_,pulse){if(null!=this.value&&!_.modified())return pulse.StopPropagation;var locale=pulse.dataflow.locale(),out=pulse.fork(pulse.NO_SOURCE|
pulse.NO_FIELDS),items=this.value,type=_.type||vegaScale.SymbolLegend,scale=_.scale,limit=+_.limit,count=vegaScale.tickCount(scale,null==_.count?5:_.count,_.minstep),lskip=!!_.values||type===vegaScale.SymbolLegend,format=_.format||vegaScale.labelFormat(locale,scale,count,type,_.formatSpecifier,_.formatType,lskip),values=_.values||vegaScale.labelValues(scale,count),size;items&&(out.rem=items);if(type===vegaScale.SymbolLegend){if(limit&&values.length>limit){pulse.dataflow.warn("Symbol legend count exceeds limit, filtering items.");
items=values.slice(0,limit-1);var ellipsis=!0}else items=values;if(vegaUtil.isFunction(size=_.size)){_.values||0!==scale(items[0])||(items=items.slice(1));var offset=items.reduce(function(max,value){return Math.max(max,size(value,_))},0)}else size=vegaUtil.constant(offset=size||8);items=items.map(function(value,index){return vegaDataflow.ingest({index:index,label:format(value,index,items),value:value,offset:offset,size:size(value,_)})});ellipsis&&(ellipsis=values[items.length],items.push(vegaDataflow.ingest({index:items.length,
label:"â€¦"+(values.length-items.length)+" entries",value:ellipsis,offset:offset,size:size(ellipsis,_)})))}else if(type===vegaScale.GradientLegend){pulse=scale.domain();var fraction=vegaScale.scaleFraction(scale,pulse[0],vegaUtil.peek(pulse));3>values.length&&!_.values&&pulse[0]!==vegaUtil.peek(pulse)&&(values=[pulse[0],vegaUtil.peek(pulse)]);items=values.map(function(value,index){return vegaDataflow.ingest({index:index,label:format(value,index,values),value:value,perc:fraction(value)})})}else size=
values.length-1,fraction=vegaScale.labelFraction(scale),items=values.map(function(value,index){return vegaDataflow.ingest({index:index,label:format(value,index,values),value:value,perc:index?fraction(value):0,perc2:index===size?1:fraction(values[index+1])})});out.source=items;this.value=out.add=items;return out}});var sourceX=function(t){return t.source.x},sourceY=function(t){return t.source.y},targetX=function(t){return t.target.x},targetY=function(t){return t.target.y};LinkPath.Definition={type:"LinkPath",
metadata:{modifies:!0},params:[{name:"sourceX",type:"field","default":"source.x"},{name:"sourceY",type:"field","default":"source.y"},{name:"targetX",type:"field","default":"target.x"},{name:"targetY",type:"field","default":"target.y"},{name:"orient",type:"enum","default":"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum","default":"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string","default":"path"}]};vegaUtil.inherits(LinkPath,
vegaDataflow.Transform,{transform:function(_,pulse){var sx=_.sourceX||sourceX,sy=_.sourceY||sourceY,tx=_.targetX||targetX,ty=_.targetY||targetY,as=_.as||"path",shape=_.shape||"line",path=Paths.get(shape+"-"+(_.orient||"vertical"))||Paths.get(shape);path||vegaUtil.error("LinkPath unsupported type: "+_.shape+(_.orient?"-"+_.orient:""));pulse.visit(pulse.SOURCE,function(t){t[as]=path(sx(t),sy(t),tx(t),ty(t))});return pulse.reflow(_.modified()).modifies(as)}});var line=function(sx,sy,tx,ty){return"M"+
sx+","+sy+"L"+tx+","+ty},arc=function(sx,sy,tx,ty){var dx=tx-sx,dy=ty-sy,rr=Math.sqrt(dx*dx+dy*dy)/2;return"M"+sx+","+sy+"A"+rr+","+rr+" "+180*Math.atan2(dy,dx)/Math.PI+" 0 1 "+tx+","+ty},curve=function(sx,sy,tx,ty){var dx=tx-sx,dy=ty-sy,ix=.2*(dx+dy);dx=.2*(dy-dx);return"M"+sx+","+sy+"C"+(sx+ix)+","+(sy+dx)+" "+(tx+dx)+","+(ty-ix)+" "+tx+","+ty},Paths=vegaUtil.fastmap({line:line,"line-radial":function(sa,sr,ta,tr){return line(sr*Math.cos(sa),sr*Math.sin(sa),tr*Math.cos(ta),tr*Math.sin(ta))},arc:arc,
"arc-radial":function(sa,sr,ta,tr){return arc(sr*Math.cos(sa),sr*Math.sin(sa),tr*Math.cos(ta),tr*Math.sin(ta))},curve:curve,"curve-radial":function(sa,sr,ta,tr){return curve(sr*Math.cos(sa),sr*Math.sin(sa),tr*Math.cos(ta),tr*Math.sin(ta))},"orthogonal-horizontal":function(sx,sy,tx,ty){return"M"+sx+","+sy+"V"+ty+"H"+tx},"orthogonal-vertical":function(sx,sy,tx,ty){return"M"+sx+","+sy+"H"+tx+"V"+ty},"orthogonal-radial":function(sa,sr,ta,tr){var tc=Math.cos(ta),ts=Math.sin(ta);return"M"+sr*Math.cos(sa)+
","+sr*Math.sin(sa)+"A"+sr+","+sr+" 0 0,"+((Math.abs(ta-sa)>Math.PI?ta<=sa:ta>sa)?1:0)+" "+sr*tc+","+sr*ts+"L"+tr*tc+","+tr*ts},"diagonal-horizontal":function(sx,sy,tx,ty){var m=(sx+tx)/2;return"M"+sx+","+sy+"C"+m+","+sy+" "+m+","+ty+" "+tx+","+ty},"diagonal-vertical":function(sx,sy,tx,ty){var m=(sy+ty)/2;return"M"+sx+","+sy+"C"+sx+","+m+" "+tx+","+m+" "+tx+","+ty},"diagonal-radial":function(sa,sr,ta,tr){var sc=Math.cos(sa);sa=Math.sin(sa);var tc=Math.cos(ta);ta=Math.sin(ta);var mr=(sr+tr)/2;return"M"+
sr*sc+","+sr*sa+"C"+mr*sc+","+mr*sa+" "+mr*tc+","+mr*ta+" "+tr*tc+","+tr*ta}});Pie.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number","default":0},{name:"endAngle",type:"number","default":6.283185307179586},{name:"sort",type:"boolean","default":!1},{name:"as",type:"string",array:!0,length:2,"default":["startAngle","endAngle"]}]};vegaUtil.inherits(Pie,vegaDataflow.Transform,{transform:function(_,pulse){var as=_.as||["startAngle","endAngle"],
startAngle=as[0],endAngle=as[1],start=_.startAngle||0,stop=null!=_.endAngle?_.endAngle:2*Math.PI,data=pulse.source,values=data.map(_.field||vegaUtil.one),n=values.length,a$jscomp$0=start;start=(stop-start)/d3Array.sum(values);stop=d3Array.range(n);var i;_.sort&&stop.sort(function(a,b){return values[a]-values[b]});for(i=0;i<n;++i){var v=values[stop[i]];var t=data[stop[i]];t[startAngle]=a$jscomp$0;t[endAngle]=a$jscomp$0+=v*start}this.value=values;return pulse.reflow(_.modified()).modifies(as)}});var SKIP=
vegaUtil.toSet("set modified clear type scheme schemeExtent schemeCount domain domainMin domainMid domainMax domainRaw domainImplicit nice zero bins range rangeStep round reverse interpolate interpolateGamma".split(" "));vegaUtil.inherits(Scale,vegaDataflow.Transform,{transform:function(_,pulse){var df=pulse.dataflow,scale=this.value;var key=_.type;var d="";if(key===vegaScale.Sequential)key=vegaScale.Sequential+"-"+vegaScale.Linear;else{var t=_.type;vegaScale.isContinuous(t)&&t!==vegaScale.Time&&
t!==vegaScale.UTC&&(_.scheme||_.range&&_.range.length&&_.range.every(vegaUtil.isString))&&(d=_.rawDomain?_.rawDomain.length:_.domain?_.domain.length+ +(null!=_.domainMid):0,d=2===d?vegaScale.Sequential+"-":3===d?vegaScale.Diverging+"-":"");key=(d+key||vegaScale.Linear).toLowerCase()}scale&&key===scale.type||(this.value=scale=vegaScale.scale(key)());for(key in _)SKIP[key]||"padding"===key&&includePad(scale.type)||(vegaUtil.isFunction(scale[key])?scale[key](_[key]):df.warn("Unsupported scale property: "+
key));d=key=scale;(t=_.domainRaw)?(scale.domain(domainCheck(scale.type,t,df)),t=t.length):t=-1;if(-1<t)df=t;else{var domain=_.domain;t=scale.type;var JSCompiler_temp;!(JSCompiler_temp=_.zero)&&(JSCompiler_temp=void 0===_.zero)&&(JSCompiler_temp=scale.type,JSCompiler_temp=!scale.bins&&(JSCompiler_temp===vegaScale.Linear||JSCompiler_temp===vegaScale.Pow||JSCompiler_temp===vegaScale.Sqrt));if(domain){if(includePad(t)&&_.padding&&domain[0]!==vegaUtil.peek(domain)){var range=_.range,pad=_.padding;var n=
_.exponent;var constant=_.constant;range=Math.abs(vegaUtil.peek(range)-range[0]);pad=range/(range-2*pad);n=t===vegaScale.Log?vegaUtil.zoomLog(domain,null,pad):t===vegaScale.Sqrt?vegaUtil.zoomPow(domain,null,pad,.5):t===vegaScale.Pow?vegaUtil.zoomPow(domain,null,pad,n||1):t===vegaScale.Symlog?vegaUtil.zoomSymlog(domain,null,pad,constant||1):vegaUtil.zoomLinear(domain,null,pad);domain=domain.slice();domain[0]=n[0];domain[domain.length-1]=n[1]}if(JSCompiler_temp||null!=_.domainMin||null!=_.domainMax||
null!=_.domainMid)n=(domain=domain.slice()).length-1||1,JSCompiler_temp&&(0<domain[0]&&(domain[0]=0),0>domain[n]&&(domain[n]=0)),null!=_.domainMin&&(domain[0]=_.domainMin),null!=_.domainMax&&(domain[n]=_.domainMax),null!=_.domainMid&&(JSCompiler_temp=_.domainMid,constant=JSCompiler_temp>domain[n]?n+1:JSCompiler_temp<domain[0]?0:n,constant!==n&&df.warn("Scale domainMid exceeds domain min or max.",JSCompiler_temp),domain.splice(constant,0,JSCompiler_temp));scale.domain(domainCheck(t,domain,df));t===
vegaScale.Ordinal&&scale.unknown(_.domainImplicit?vegaScale.scaleImplicit:void 0);_.nice&&scale.nice&&scale.nice(!0!==_.nice&&vegaScale.tickCount(scale,_.nice)||null);df=domain.length}else df=0}(t=_.bins)&&!vegaUtil.isArray(t)&&(JSCompiler_temp=d.domain(),scale=JSCompiler_temp[0],JSCompiler_temp=vegaUtil.peek(JSCompiler_temp),domain=t.step,n=null==t.start?scale:t.start,t=null==t.stop?JSCompiler_temp:t.stop,domain||vegaUtil.error("Scale bins parameter missing step property."),n<scale&&(n=domain*Math.ceil(scale/
domain)),t>JSCompiler_temp&&(t=domain*Math.floor(JSCompiler_temp/domain)),t=d3Array.range(n,t+domain/2,domain));t?d.bins=t:d.bins&&delete d.bins;d.type===vegaScale.BinOrdinal&&(t?_.domain||_.domainRaw||(d.domain(t),df=t.length):d.bins=d.domain());scale=df;a:{d=key.type;df=_.round||!1;t=_.range;if(null!=_.rangeStep)d!==vegaScale.Band&&d!==vegaScale.Point&&vegaUtil.error("Only band and point scales support rangeStep."),t=[0,_.rangeStep*vegaScale.bandSpace(scale,d===vegaScale.Point?1:(null!=_.paddingInner?
_.paddingInner:_.padding)||0,(null!=_.paddingOuter?_.paddingOuter:_.padding)||0)];else if(_.scheme&&(t=_.schemeExtent,vegaUtil.isArray(_.scheme)?JSCompiler_temp=vegaScale.interpolateColors(_.scheme,_.interpolate,_.interpolateGamma):(JSCompiler_temp=_.scheme.toLowerCase(),(JSCompiler_temp=vegaScale.scheme(JSCompiler_temp))||vegaUtil.error("Unrecognized scheme name: "+_.scheme)),scale=d===vegaScale.Threshold?scale+1:d===vegaScale.BinOrdinal?scale-1:d===vegaScale.Quantile||d===vegaScale.Quantize?+_.schemeCount||
5:scale,t=vegaScale.isInterpolating(d)?adjustScheme(JSCompiler_temp,t,_.reverse):vegaUtil.isFunction(JSCompiler_temp)?vegaScale.quantizeInterpolator(adjustScheme(JSCompiler_temp,t),scale):d===vegaScale.Ordinal?JSCompiler_temp:JSCompiler_temp.slice(0,scale),vegaUtil.isFunction(t)))if(key.interpolator){key.interpolator(t);break a}else vegaUtil.error("Scale type "+d+" does not support interpolating color schemes.");t&&vegaScale.isInterpolating(d)?key.interpolator(vegaScale.interpolateColors(flip(t,_.reverse),
_.interpolate,_.interpolateGamma)):(t&&_.interpolate&&key.interpolate?key.interpolate(vegaScale.interpolate(_.interpolate,_.interpolateGamma)):vegaUtil.isFunction(key.round)?key.round(df):vegaUtil.isFunction(key.rangeRound)&&key.interpolate(df?d3Interpolate.interpolateRound:d3Interpolate.interpolate),t&&key.range(flip(t,_.reverse)))}return pulse.fork(pulse.NO_SOURCE|pulse.NO_FIELDS)}});vegaUtil.inherits(SortItems,vegaDataflow.Transform,{transform:function(_,pulse){var mod=_.modified("sort")||pulse.changed(pulse.ADD)||
pulse.modified(_.sort.fields)||pulse.modified("datum");mod&&pulse.source.sort(vegaDataflow.stableCompare(_.sort));this.modified(mod);return pulse}});var DefOutput=["y0","y1"];Stack.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum","default":"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,"default":DefOutput}]};vegaUtil.inherits(Stack,
vegaDataflow.Transform,{transform:function(_,pulse){var as=_.as||DefOutput,y0=as[0],y1=as[1],sort=vegaDataflow.stableCompare(_.sort),field=_.field||vegaUtil.one,stack="center"===_.offset?stackCenter:"normalize"===_.offset?stackNormalize:stackZero,max;sort=partition(pulse.source,_.groupby,sort,field);var i=0;var n=sort.length;for(max=sort.max;i<n;++i)stack(sort[i],max,field,y0,y1);return pulse.reflow(_.modified()).modifies(as)}});exports.axisticks=AxisTicks;exports.datajoin=DataJoin;exports.encode=
Encode;exports.legendentries=LegendEntries;exports.linkpath=LinkPath;exports.pie=Pie;exports.scale=Scale;exports.sortitems=SortItems;exports.stack=Stack;Object.defineProperty(exports,"__esModule",{value:!0})})}
//# sourceMappingURL=module$node_modules$vega_encode$build$vega_encode.js.map
